<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAR Image Tracking</title>
    
    <script>
        console.log("üîµ –ó–∞–≥—Ä—É–∑–∫–∞ A-Frame –∏ MindAR...");
    </script>

    <script src="https://aframe.io/releases/1.6.0/aframe.min.js" onerror="console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ aframe.min.js')"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.0/dist/mindar-image-aframe.prod.js" onerror="console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ mindar-image-aframe.prod.js')"></script>

    <style>
        /* –£–±–∏—Ä–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –∏ –¥–µ–ª–∞–µ–º –∫–∞–º–µ—Ä—É –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        a-scene {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw !important;
            height: 100vh !important;
        }
    </style>
</head>
<body>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            console.log("‚úÖ DOM –∑–∞–≥—Ä—É–∂–µ–Ω");
        });

        navigator.mediaDevices.getUserMedia({ video: true })
            .then((stream) => {
                console.log("‚úÖ –ö–∞–º–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞");
            })
            .catch((err) => console.error("‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ:", err));

        AFRAME.registerComponent('debugger', {
            init: function () {
                console.log("üü° –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è A-Frame...");
                this.el.sceneEl.addEventListener('loaded', () => {
                    console.log("‚úÖ A-Frame —Å—Ü–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞");
                });
            }
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Å–∞–π–∑ —Å—Ü–µ–Ω—ã
        window.addEventListener("resize", () => {
            const scene = document.querySelector("a-scene");
            if (scene) {
                scene.style.width = `${window.innerWidth}px`;
                scene.style.height = `${window.innerHeight}px`;
            }
        });
    </script>

    <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind;" embedded debugger>
        <a-camera mindar-camera="true" position="0 0 0" look-controls-enabled="false" cursor="rayOrigin: mouse"></a-camera>

        <a-assets>
            <!-- –í–∏–¥–µ–æ —Å CDN -->
            <video id="video1" src="http://77.94.102.134/video1.mp4" loop playsinline preload="auto"></video>
            <video id="video2" src="http://77.94.102.134/video2.mp4" loop playsinline preload="auto"></video>
        </a-assets>

        <a-entity mindar-image-targets>
            <!-- –ü–µ—Ä–≤—ã–π –º–∞—Ä–∫–µ—Ä -->
            <a-entity mindar-image-target="targetIndex: 0">
                <a-video id="video1-entity" src="#video1" position="0 0 0" width="1.77" height="1" rotation="-90 0 0"></a-video>
            </a-entity>

            <!-- –í—Ç–æ—Ä–æ–π –º–∞—Ä–∫–µ—Ä -->
            <a-entity mindar-image-target="targetIndex: 1">
                <a-video id="video2-entity" src="#video2" position="0 0 0" width="1.77" height="1" rotation="-90 0 0"></a-video>
            </a-entity>
        </a-entity>
    </a-scene>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            console.log("üü° –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏–¥–µ–æ...");

            const video1 = document.getElementById("video1");
            const video2 = document.getElementById("video2");

            video1.oncanplay = () => console.log("‚úÖ –í–∏–¥–µ–æ 1 –∑–∞–≥—Ä—É–∂–µ–Ω–æ");
            video2.oncanplay = () => console.log("‚úÖ –í–∏–¥–µ–æ 2 –∑–∞–≥—Ä—É–∂–µ–Ω–æ");

            const marker1 = document.querySelector('[mindar-image-target="targetIndex: 0"]');
            const marker2 = document.querySelector('[mindar-image-target="targetIndex: 1"]');

            marker1.addEventListener("targetFound", () => {
                console.log("‚úÖ –ú–∞—Ä–∫–µ—Ä 1 –Ω–∞–π–¥–µ–Ω! –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –≤–∏–¥–µ–æ 1...");
                video1.play();
                video1.muted = false;
            });

            marker1.addEventListener("targetLost", () => {
                console.log("üõë –ú–∞—Ä–∫–µ—Ä 1 –ø–æ—Ç–µ—Ä—è–Ω! –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–∏–¥–µ–æ 1...");
                video1.pause();
            });

            marker2.addEventListener("targetFound", () => {
                console.log("‚úÖ –ú–∞—Ä–∫–µ—Ä 2 –Ω–∞–π–¥–µ–Ω! –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –≤–∏–¥–µ–æ 2...");
                video2.play();
                video2.muted = false;
            });

            marker2.addEventListener("targetLost", () => {
                console.log("üõë –ú–∞—Ä–∫–µ—Ä 2 –ø–æ—Ç–µ—Ä—è–Ω! –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–∏–¥–µ–æ 2...");
                video2.pause();
            });
        });
    </script>
</body>
</html>
